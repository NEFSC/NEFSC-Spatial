---
title: "Feature Services in ArcGIS.com"
author: "Joshua Hatch"
date: "2025-03-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, error = FALSE, message = FALSE)
```

# Accessing Data Housed in a Data Hub

Feature services in ArcGIS Online allow you to share and interact with spatial data, enabling querying, editing, and displaying features on maps and in web applications. They also allow you to easily ingest spatial data into your own R workflows. 

To do this, you will first need to install the [R-ArcGIS Bridge](https://github.com/R-ArcGIS),

```{r, echo = TRUE, results='hide'}
install.packages("arcgis", repos = c("https://r-arcgis.r-universe.dev", "https://cloud.r-project.org"))
```

That's basically it! You're ready to go. Now you just need to find the url associated with the spatial data that you want to use on a data hub. 

As an example, say we're interested in using the EcoMon survey strata for some analysis. First, go to the [MDEB GIS Data Hub](https://mdeb-nefsc-noaa.hub.arcgis.com/) and click on the EcoMon Survey card or the Explore button (it'll be under the column labeled Fisheries-Independent Surveys). That will bring you to the landing page for the feature service. Scroll down to the Layers section, you'll see two options: 1) ECOMON_Strata and 2) ECOMON_Stations. Click on the layer you're interested in using, which for this vignette is the ECOMON_Strata layer. This will bring you to an interactive map that will provide a preview of the strata. You can now choose to download the data in a variety of formats, but we'll make use of the REST API endpoint. To get to that, click on the View Full Details button under the Summary section. Now scroll down and toggle the View API Resources tab, which will reveal two urls. Copy the url under the GeoService section, 

```{r, echo = TRUE}
## download EcoMon Survey strata from MDEB GIS Data Hub
ecomon_strata = arcgislayers::arc_read('https://services2.arcgis.com/C8EMgrsFcRFL6LrL/arcgis/rest/services/Ecosystem_Monitoring_Strata/FeatureServer/0/query?outFields=*&where=1%3D1')

## take a look, it's an sf data frame
ecomon_strata
```

There are also functions to read in metadata, in case you have questions about the data columns and what they mean. Or you can just refer back to the Layer webpage, metadata is also displayed there (and links to InPort entries, if available).